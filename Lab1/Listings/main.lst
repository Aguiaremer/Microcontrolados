


ARM Macro Assembler    Page 1 


    1 00000000         ; main.s
    2 00000000         ; Desenvolvido para a placa EK-TM4C1294XL
    3 00000000         ; Prof. Guilherme Peron
    4 00000000         ; 15/03/2018
    5 00000000         ; Este programa espera o usuário apertar a chave USR_SW1
                        e/ou a chave USR_SW2.
    6 00000000         ; Caso o usuário pressione a chave USR_SW1, acenderá o L
                       ED2. Caso o usuário pressione 
    7 00000000         ; a chave USR_SW2, acenderá o LED1. Caso as duas chaves 
                       sejam pressionadas, os dois 
    8 00000000         ; LEDs acendem.
    9 00000000         
   10 00000000         ; ------------------------------------------------------
                       -------------------------
   11 00000000                 THUMB                        ; Instruções do tip
                                                            o Thumb-2
   12 00000000         ; ------------------------------------------------------
                       -------------------------
   13 00000000         
   14 00000000         ; ------------------------------------------------------
                       -------------------------
   15 00000000         ; Área de Dados - Declarações de variáveis
   16 00000000                 AREA             DATA, ALIGN=2
   17 00000000         ; Se alguma variável for chamada em outro arquivo
   18 00000000         ;EXPORT  <var> [DATA,SIZE=<tam>]   ; Permite chamar a va
                       riável <var> a 
   19 00000000         ; partir de outro arquivo
   20 00000000         ;<var> SPACE <tam>                        ; Declara uma 
                       variável de nome <var>
   21 00000000         ; de <tam> bytes a partir da primeira 
   22 00000000         ; posição da RAM  
   23 00000000         
   24 00000000         ; ------------------------------------------------------
                       -------------------------
   25 00000000         ; Área de Código - Tudo abaixo da diretiva a seguir será
                        armazenado na memória de 
   26 00000000         ;                  código
   27 00000000                 AREA             |.text|, CODE, READONLY, ALIGN=
2
   28 00000000         
   29 00000000         ; Se alguma função do arquivo for chamada em outro arqui
                       vo 
   30 00000000                 EXPORT           Start       ; Permite chamar a 
                                                            função Start a part
                                                            ir de 
   31 00000000         ; outro arquivo. No caso startup.s
   32 00000000         
   33 00000000         ; Se chamar alguma função externa 
   34 00000000         ;IMPORT <func>              ; Permite chamar dentro dest
                       e arquivo uma 
   35 00000000         ; função <func>
   36 00000000                 IMPORT           PLL_Init
   37 00000000                 IMPORT           SysTick_Init
   38 00000000                 IMPORT           SysTick_Wait1ms
   39 00000000                 IMPORT           GPIO_Init
   40 00000000                 IMPORT           PortN_Output
   41 00000000                 IMPORT           PortA_Output
   42 00000000                 IMPORT           PortQ_Output
   43 00000000                 IMPORT           PortB_Output



ARM Macro Assembler    Page 2 


   44 00000000                 IMPORT           PortP_Output
   45 00000000         
   46 00000000         ; ------------------------------------------------------
                       -------------------------
   47 00000000         ; Função main()
   48 00000000         Start
   49 00000000 F7FF FFFE       BL               PLL_Init    ;Chama a subrotina 
                                                            para alterar o cloc
                                                            k do microcontrolad
                                                            or para 80MHz
   50 00000004 F7FF FFFE       BL               SysTick_Init ;Chama a subrotina
                                                             para inicializar o
                                                             SysTick
   51 00000008 F7FF FFFE       BL               GPIO_Init   ;Chama a subrotina 
                                                            que inicializa os G
                                                            PIO
   52 0000000C F000 F86B       BL               Tabela_Display_7seg
   53 00000010         
   54 00000010 F04F 0A0F       LDR              R10, =15    ;Temperatura atual 
                                                            inicial
   55 00000014 F04F 0B19       LDR              R11, =25    ;Temperatura alvo i
                                                            nicial
   56 00000018 F04F 040A       LDR              R4,  =10    ;divisor
   57 0000001C F04F 06A7       LDR              R6, =167    ;contador de um seg
                                                            undo
   58 00000020         MainLoop
   59 00000020         
   60 00000020 FBBA F5F4       UDIV             R5, R10, R4 ;Dezenas da tempera
                                                            tura atual R5 = dez
                                                            enas (R10 / R4)
   61 00000024 F81C 0005       LDRB             R0, [R12,R5] ;Carrega as config
                                                            urações do pino par
                                                            a o display de 7 se
                                                            gmentos de acordo c
                                                            om o numero da tabe
                                                            la na memoria RAM
   62 00000028 F7FF FFFE       BL               PortA_Output ;Chama a função pa
                                                            ra habilitar o pino
                                                            s PA7 a PA4
   63 0000002C F7FF FFFE       BL               PortQ_Output ;Chama a função pa
                                                            ra habilitar o pino
                                                            s PQ3 a PQ0
   64 00000030         
   65 00000030 F04F 0010       LDR              R0,=2_00010000 ;Seta R0 como pa
                                                            rametro de entrada 
                                                            de função para habi
                                                            litar transistor Q2
                                                            
   66 00000034 F7FF FFFE       BL               PortB_Output ;Chama a função da
                                                             porta B 
   67 00000038 F04F 0001       LDR              R0,=1       ;Seta R0 como param
                                                            etro de entrada de 
                                                            função para esperar
                                                             1 ms
   68 0000003C F7FF FFFE       BL               SysTick_Wait1ms ;Chama a função
                                                             de espera
   69 00000040         
   70 00000040 F04F 0000       LDR              R0,=2_00000000 ;Seta R0 como pa
                                                            rametro de entrada 



ARM Macro Assembler    Page 3 


                                                            de função para desa
                                                            bilitar transistor 
                                                            Q2
   71 00000044 F7FF FFFE       BL               PortB_Output ;Chama a função da
                                                             porta B 
   72 00000048 F04F 0001       LDR              R0,=1       ;Seta R0 como param
                                                            etro de entrada de 
                                                            função para esperar
                                                             1 ms
   73 0000004C F7FF FFFE       BL               SysTick_Wait1ms ;Chama a função
                                                             de espera
   74 00000050         
   75 00000050 FB05 A514       MLS              R5, R5, R4, R10 ;Unidades da te
                                                            mepratura atual R5 
                                                            = unidades (R10 - (
                                                            R5 * R4))
   76 00000054 F81C 0005       LDRB             R0, [R12,R5] ;Carrega as config
                                                            urações do pino par
                                                            a o display de 7 se
                                                            gmentos de acordo c
                                                            om o numero da tabe
                                                            la na memoria RAM
   77 00000058 F7FF FFFE       BL               PortA_Output ;Chama a função pa
                                                            ra habilitar o pino
                                                            s PA7 a PA4
   78 0000005C F7FF FFFE       BL               PortQ_Output ;Chama a função pa
                                                            ra habilitar o pino
                                                            s PQ3 a PQ0
   79 00000060         
   80 00000060 F04F 0020       LDR              R0,=2_00100000 ;Seta R0 como pa
                                                            rametro de entrada 
                                                            de função para habi
                                                            litar transistor Q1
                                                            
   81 00000064 F7FF FFFE       BL               PortB_Output ;Chama a função da
                                                             porta B 
   82 00000068 F04F 0001       LDR              R0,=1       ;Seta R0 como param
                                                            etro de entrada de 
                                                            função para esperar
                                                             1 ms
   83 0000006C F7FF FFFE       BL               SysTick_Wait1ms ;Chama a função
                                                             de espera
   84 00000070         
   85 00000070 F04F 0000       LDR              R0,=2_00000000 ;Seta R0 como pa
                                                            rametro de entrada 
                                                            de função para desa
                                                            bilitar transistor 
                                                            Q1
   86 00000074 F7FF FFFE       BL               PortB_Output ;Chama a função da
                                                             porta B 
   87 00000078 F04F 0001       LDR              R0,=1       ;Seta R0 como param
                                                            etro de entrada de 
                                                            função para esperar
                                                             1 ms
   88 0000007C F7FF FFFE       BL               SysTick_Wait1ms ;Chama a função
                                                             de espera
   89 00000080         
   90 00000080 4658            MOV              R0, R11
   91 00000082 F7FF FFFE       BL               PortA_Output ;Chama a função pa



ARM Macro Assembler    Page 4 


                                                            ra habilitar o pino
                                                            s PA7 a PA4
   92 00000086 F7FF FFFE       BL               PortQ_Output ;Chama a função pa
                                                            ra habilitar o pino
                                                            s PQ3 a PQ0
   93 0000008A         
   94 0000008A F04F 0020       LDR              R0,=2_00100000 ;Seta R0 como pa
                                                            rametro de entrada 
                                                            de função para habi
                                                            litar transistor Q1
                                                            
   95 0000008E F7FF FFFE       BL               PortP_Output ;Chama a função da
                                                             porta B 
   96 00000092 F04F 0001       LDR              R0,=1       ;Seta R0 como param
                                                            etro de entrada de 
                                                            função para esperar
                                                             1 ms
   97 00000096 F7FF FFFE       BL               SysTick_Wait1ms ;Chama a função
                                                             de espera
   98 0000009A         
   99 0000009A F04F 0000       LDR              R0,=2_00000000 ;Seta R0 como pa
                                                            rametro de entrada 
                                                            de função para desa
                                                            bilitar transistor 
                                                            Q1
  100 0000009E F7FF FFFE       BL               PortP_Output ;Chama a função da
                                                             porta B 
  101 000000A2 F04F 0001       LDR              R0,=1       ;Seta R0 como param
                                                            etro de entrada de 
                                                            função para esperar
                                                             1 ms
  102 000000A6 F7FF FFFE       BL               SysTick_Wait1ms ;Chama a função
                                                             de espera
  103 000000AA         
  104 000000AA F1A6 0601       SUB              R6,R6,#1
  105 000000AE 2E00            CMP              R6,#0
  106 000000B0 D900            BLS              Passou_1s
  107 000000B2         
  108 000000B2 E7B5            B                MainLoop
  109 000000B4         
  110 000000B4         ; ------------------------------------------------------
                       -------------------------
  111 000000B4         ; Função Passou_1s
  112 000000B4         Passou_1s
  113 000000B4 F04F 06A7       LDR              R6,=167
  114 000000B8 45DA            CMP              R10,R11
  115 000000BA DB01            BLT              T_atual_menor_que
  116 000000BC D807            BHI              T_atual_maior_que
  117 000000BE D00D            BEQ              T_atual_igual
  118 000000C0         T_atual_menor_que
  119 000000C0 F10A 0A01       ADD              R10,R10,#1
  120 000000C4 F04F 0001       LDR              R0, =2_01
  121 000000C8 F7FF FFFE       BL               PortN_Output
  122 000000CC E7A8            B                MainLoop
  123 000000CE         T_atual_maior_que
  124 000000CE F1AA 0A01       SUB              R10,R10,#1
  125 000000D2 F04F 0002       LDR              R0, =2_10
  126 000000D6 F7FF FFFE       BL               PortN_Output
  127 000000DA E7A1            B                MainLoop



ARM Macro Assembler    Page 5 


  128 000000DC         T_atual_igual
  129 000000DC F04F 0003       LDR              R0, =2_11
  130 000000E0 F7FF FFFE       BL               PortN_Output
  131 000000E4 E79C            B                MainLoop
  132 000000E6         
  133 000000E6         ; ------------------------------------------------------
                       -------------------------
  134 000000E6         ; Função Tabela_Display_7seg
  135 000000E6         ; Parâmetro de entrada: R5 --> numero
  136 000000E6         ; Parâmetro de saída: R0 -> saida dos pinos
  137 000000E6         Tabela_Display_7seg
  138 000000E6 F04F 5C00       LDR              R12, =0x20000000 
                                                            ; base da tabela
  139 000000EA F04F 013F       MOV              R1, #2_00111111 
                                                            ; valor p/ dígito 0
                                                            
  140 000000EE F88C 1000       STRB             R1, [R12,#0] ; guarda na posiçã
                                                            o 0
  141 000000F2         
  142 000000F2 F04F 0106       MOV              R1, #2_00000110 
                                                            ; valor p/ dígito 1
                                                            
  143 000000F6 F88C 1001       STRB             R1, [R12,#1]
  144 000000FA         
  145 000000FA F04F 015B       MOV              R1, #2_01011011 
                                                            ; valor p/ dígito 2
                                                            
  146 000000FE F88C 1002       STRB             R1, [R12,#2]
  147 00000102         
  148 00000102 F04F 014F       MOV              R1, #2_01001111 
                                                            ; valor p/ dígito 3
                                                            
  149 00000106 F88C 1003       STRB             R1, [R12,#3]
  150 0000010A         
  151 0000010A F04F 0166       MOV              R1, #2_01100110 
                                                            ; valor p/ dígito 4
                                                            
  152 0000010E F88C 1004       STRB             R1, [R12,#4]
  153 00000112         
  154 00000112 F04F 016D       MOV              R1, #2_01101101 
                                                            ; valor p/ dígito 5
                                                            
  155 00000116 F88C 1005       STRB             R1, [R12,#5]
  156 0000011A         
  157 0000011A F04F 017D       MOV              R1, #2_01111101 
                                                            ; valor p/ dígito 6
                                                            
  158 0000011E F88C 1006       STRB             R1, [R12,#6]
  159 00000122         
  160 00000122 F04F 0107       MOV              R1, #2_00000111 
                                                            ; valor p/ dígito 7
                                                            
  161 00000126 F88C 1007       STRB             R1, [R12,#7]
  162 0000012A         
  163 0000012A F04F 017F       MOV              R1, #2_01111111 
                                                            ; valor p/ dígito 8
                                                            
  164 0000012E F88C 1008       STRB             R1, [R12,#8]
  165 00000132         



ARM Macro Assembler    Page 6 


  166 00000132 F04F 016F       MOV              R1, #2_01101111 
                                                            ; valor p/ dígito 9
                                                            
  167 00000136 F88C 1009       STRB             R1, [R12,#9]
  168 0000013A         
  169 0000013A 4770            BX               LR
  170 0000013C         
  171 0000013C         
  172 0000013C         
  173 0000013C         
  174 0000013C         
  175 0000013C         
  176 0000013C                 ALIGN                        ;Garante que o fim 
                                                            da seção está alinh
                                                            ada 
  177 0000013C                 END                          ;Fim do arquivo
Command Line: --debug --xref --diag_suppress=9931,A1950W --cpu=Cortex-M4.fp.sp 
--depend=.\objects\main.d -o.\objects\main.o -IC:\Users\aguia\AppData\Local\Arm
\Packs\Keil\TM4C_DFP\1.1.0\Device\Include\TM4C129 --predefine="__EVAL SETA 1" -
-predefine="__UVISION_VERSION SETA 543" --predefine="TM4C1294NCPDT SETA 1" --li
st=.\listings\main.lst main.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

DATA 00000000

Symbol: DATA
   Definitions
      At line 16 in file main.s
   Uses
      None
Comment: DATA unused
1 symbol



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

.text 00000000

Symbol: .text
   Definitions
      At line 27 in file main.s
   Uses
      None
Comment: .text unused
MainLoop 00000020

Symbol: MainLoop
   Definitions
      At line 58 in file main.s
   Uses
      At line 108 in file main.s
      At line 122 in file main.s
      At line 127 in file main.s
      At line 131 in file main.s

Passou_1s 000000B4

Symbol: Passou_1s
   Definitions
      At line 112 in file main.s
   Uses
      At line 106 in file main.s
Comment: Passou_1s used once
Start 00000000

Symbol: Start
   Definitions
      At line 48 in file main.s
   Uses
      At line 30 in file main.s
Comment: Start used once
T_atual_igual 000000DC

Symbol: T_atual_igual
   Definitions
      At line 128 in file main.s
   Uses
      At line 117 in file main.s
Comment: T_atual_igual used once
T_atual_maior_que 000000CE

Symbol: T_atual_maior_que
   Definitions
      At line 123 in file main.s
   Uses
      At line 116 in file main.s
Comment: T_atual_maior_que used once
T_atual_menor_que 000000C0

Symbol: T_atual_menor_que
   Definitions
      At line 118 in file main.s
   Uses
      At line 115 in file main.s
Comment: T_atual_menor_que used once



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

Tabela_Display_7seg 000000E6

Symbol: Tabela_Display_7seg
   Definitions
      At line 137 in file main.s
   Uses
      At line 52 in file main.s
Comment: Tabela_Display_7seg used once
8 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

GPIO_Init 00000000

Symbol: GPIO_Init
   Definitions
      At line 39 in file main.s
   Uses
      At line 51 in file main.s
Comment: GPIO_Init used once
PLL_Init 00000000

Symbol: PLL_Init
   Definitions
      At line 36 in file main.s
   Uses
      At line 49 in file main.s
Comment: PLL_Init used once
PortA_Output 00000000

Symbol: PortA_Output
   Definitions
      At line 41 in file main.s
   Uses
      At line 62 in file main.s
      At line 77 in file main.s
      At line 91 in file main.s

PortB_Output 00000000

Symbol: PortB_Output
   Definitions
      At line 43 in file main.s
   Uses
      At line 66 in file main.s
      At line 71 in file main.s
      At line 81 in file main.s
      At line 86 in file main.s

PortN_Output 00000000

Symbol: PortN_Output
   Definitions
      At line 40 in file main.s
   Uses
      At line 121 in file main.s
      At line 126 in file main.s
      At line 130 in file main.s

PortP_Output 00000000

Symbol: PortP_Output
   Definitions
      At line 44 in file main.s
   Uses
      At line 95 in file main.s
      At line 100 in file main.s

PortQ_Output 00000000

Symbol: PortQ_Output



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
External symbols

   Definitions
      At line 42 in file main.s
   Uses
      At line 63 in file main.s
      At line 78 in file main.s
      At line 92 in file main.s

SysTick_Init 00000000

Symbol: SysTick_Init
   Definitions
      At line 37 in file main.s
   Uses
      At line 50 in file main.s
Comment: SysTick_Init used once
SysTick_Wait1ms 00000000

Symbol: SysTick_Wait1ms
   Definitions
      At line 38 in file main.s
   Uses
      At line 68 in file main.s
      At line 73 in file main.s
      At line 83 in file main.s
      At line 88 in file main.s
      At line 97 in file main.s
      At line 102 in file main.s

9 symbols
352 symbols in table
